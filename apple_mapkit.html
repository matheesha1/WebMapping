<!DOCTYPE html>
<html>
<!-- Described at: https://developer.apple.com/documentation/mapkitjs -->
<!-- also see https://maps.developer.apple.com -->
<head>
<meta charset="utf-8">

<script
  src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.core.js"
  crossorigin async
  data-callback="initMapKit"
  data-libraries="map"
  data-initial-token="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjY2TURRMzVNNDUifQ.eyJpc3MiOiI3RDdaNU1ROTVEIiwiaWF0IjoxNjc0ODkzNzY4LCJleHAiOjE3MDYzMTM2MDB9.dWM2fBMXd8_n-Lhg6PZiv_38lBdw2ZfnRM-FBdmB_XaLuYswS1grhOPbve0ADJjcrw895R5T7wLztGsZG-2suw"
></script>

<style>
#map {
    width: 100%;
    height: 600px;
}
</style>

</head>

<body>
<div id="map"></div>

<script type="module">
const setupMapKitJs = async() => {
    if (!window.mapkit || window.mapkit.loadedLibraries.length === 0) {
        // mapkit.core.js or the libraries are not loaded yet.
        // Set up the callback and wait for it to be called.
        await new Promise(resolve => { window.initMapKit = resolve });

        // Clean up
        delete window.initMapKit;
    }
    const tokenID = "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjY2TURRMzVNNDUifQ.eyJpc3MiOiI3RDdaNU1ROTVEIiwiaWF0IjoxNjc0ODkzNzY4LCJleHAiOjE3MDYzMTM2MDB9.dWM2fBMXd8_n-Lhg6PZiv_38lBdw2ZfnRM-FBdmB_XaLuYswS1grhOPbve0ADJjcrw895R5T7wLztGsZG-2suw";
    mapkit.init({
        authorizationCallback: function(done) {
            done(tokenID);
        }
    });
};

const main = async() => {
    await setupMapKitJs();
    // Markers
    //var MarkerAnnotation = mapkit.MarkerAnnotation;
    //var myMarker = new mapkit.Coordinate(50.678477, -1.285889);
    // Region and Zoom variables for IoW
    const iow_region = new mapkit.CoordinateRegion(
        new mapkit.Coordinate(50.678477, -1.285889),
        new mapkit.CoordinateSpan(0.20, 0.10)
    );
    //const iow_region = new mapkit.BoundingRegion(50.807634, -1.594763, 50.565998, -1.049043);
    var map = new mapkit.Map("map");
    //var myAnnotation = new MarkerAnnotation(myMarker, { color: "#9b6bcc", title: "Newport"});
    //map.showItems([myAnnotation]);
    map.region = iow_region;
  };

  main();

</script>
</body>
</html>
